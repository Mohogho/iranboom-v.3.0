<!DOCTYPE html>
<html lang="fa">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù¾Ù†Ù„ Ù…Ø´Ø§ÙˆØ±Ø§Ù† Ø§ÛŒØ±Ø§Ù† Ø¨ÙˆÙ…</title>
  <link rel="stylesheet" href="css/main.css?v=3.6.0">
</head>

<body>
  <header class="ib-header">Ø¨Ù‡ Ù¾Ù†Ù„ Ù…Ø´Ø§ÙˆØ±Ø§Ù† Ø§ÛŒØ±Ø§Ù† Ø¨ÙˆÙ… Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.</header>

  <div class="ib-container">
    <h2 class="ib-title">Ø«Ø¨Øª Ù…Ù„Ú© Ø¬Ø¯ÛŒØ¯</h2>
    <form>
      <label class="ib-label">ØªØµØ§ÙˆÛŒØ± Ù…Ù„Ú© (Ø­Ø¯Ø§Ù‚Ù„ 8 ØªØµÙˆÛŒØ±)</label>
      <input class="ib-input ib-input-file" type="file" name="images" accept="image/*" multiple required>

      <label class="ib-label">ÙˆÛŒØ¯ÛŒÙˆ Ù…Ù„Ú© (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
      <input class="ib-input ib-input-file" type="file" name="video" accept="video/*">

      <label class="ib-label">Ù†Ø§Ù… Ù…Ù„Ú©</label>
      <input class="ib-input" type="text" name="title" placeholder="Ù…Ø«Ø§Ù„: Ø¢Ù¾Ø§Ø±ØªÙ…Ø§Ù† 200 Ù…ØªØ±ÛŒ Ø¯Ø± Ø¨Ù„ÙˆØ§Ø± Ø´Ù‡Ø±Ø¯Ø§Ø±ÛŒ" required>

      <label class="ib-label">ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù…Ù„Ú©</label>
      <div class="ib-feature-input">
        <input class="ib-input" type="text" id="featureText" placeholder="Ù…Ø«Ø§Ù„: 9 Ø§ØªØ§Ù‚ Ø®ÙˆØ§Ø¨">
        <button type="button" class="ibb-button" onclick="addFeature()">Ø§ÙØ²ÙˆØ¯Ù†</button>
      </div>
      <ul class="ib-features-list" id="featureList"></ul>

      <label class="ib-label">ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ù„ÛŒ</label>
      <textarea id="description" class="ib-textarea" name="description" maxlength="4000"
        placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ù„Ú© Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ø­Ø¯Ø§Ú©Ø«Ø± 400 Ø®Ø·)"></textarea>

      <label class="ib-label">Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø¨ÙˆÙ„Ø¯ Ú©Ø±Ø¯Ù†</label>
      <input class="ib-input" type="text" id="keywords" placeholder="Ú©Ù„Ù…Ø§Øª Ø±Ø§ Ø¨Ø§ Ú©Ø§Ù…Ø§ Ø¬Ø¯Ø§ Ú©Ù†ÛŒØ¯">

      <label class="ib-label">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ ØªÙˆØ¶ÛŒØ­Ø§Øª</label>
      <ul id="descriptionPreview" class="ib-description-preview"></ul>

      <label class="ib-label">Ø¢Ø¯Ø±Ø³ Ù…Ù„Ú©</label>
      <input class="ib-input" type="text" name="address" placeholder="Ø¢Ø¯Ø±Ø³ Ø¯Ù‚ÛŒÙ‚ Ù…Ù„Ú©" required>

      <label class="ib-label">Ù‚ÛŒÙ…Øª Ù…Ù„Ú© (ØªÙˆÙ…Ø§Ù†)</label>
      <input class="ib-input" type="text" name="price" placeholder="Ù…Ø«Ø§Ù„: Û²,ÛµÛ°Û°,Û°Û°Û°,Û°Û°Û° ØªÙˆÙ…Ø§Ù†" required>

      <button type="submit" class="ib-button">Ø«Ø¨Øª Ù…Ù„Ú©</button>
    </form>
  </div>

  <script>
    // --- Ø§ÙØ²ÙˆØ¯Ù† ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ ---
    function addFeature() {
      const input = document.getElementById('featureText');
      const value = input.value.trim();
      if (!value) return;

      const li = document.createElement('li');
      const removeBtn = document.createElement('button');
      removeBtn.textContent = 'ğŸ—‘ï¸';
      removeBtn.className = 'feature-remove-btn';
      removeBtn.onclick = () => li.remove();

      li.textContent = value + ' ';
      li.appendChild(removeBtn);
      document.getElementById('featureList').appendChild(li);

      input.value = '';
      input.focus();
    }

    // --- Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ ØªÙˆØ¶ÛŒØ­Ø§Øª ---
    const desc = document.getElementById('description');
    const keywords = document.getElementById('keywords');
    const preview = document.getElementById('descriptionPreview');

    function updatePreview() {
      let text = desc.value;
      const keys = keywords.value.split(',').map(k => k.trim()).filter(k => k !== '');
      keys.forEach(k => {
        const re = new RegExp(`(${k})`, 'gi');
        text = text.replace(re, '<strong>$1</strong>');
      });
      preview.innerHTML = '<li>' + text.replace(/\n/g, '<br>') + '</li>';
    }

    desc.addEventListener('input', updatePreview);
    keywords.addEventListener('input', updatePreview);

    // --- Ø­Ø±Ú©Øª Ø¨ÛŒÙ† Ø§ÛŒÙ†Ù¾ÙˆØªâ€ŒÙ‡Ø§ Ø¨Ø§ Enter ---
    const form = document.querySelector('form');
    const inputs = Array.from(document.querySelectorAll('input, textarea'));

    inputs.forEach((el, index) => {
      el.addEventListener('keydown', function (e) {
        if (e.key === 'Enter') {
          if (el.id === 'description') {
            if (!e.shiftKey) {
              e.preventDefault();
              const next = inputs[index + 1];
              if (next) next.focus();
              updatePreview();
            }
          } else if (el.id === 'featureText') {
            e.preventDefault();
            addFeature();
          } else if (index === inputs.length - 1) {
            e.preventDefault();
            form.submit();
          } else {
            e.preventDefault();
            const next = inputs[index + 1];
            if (next) next.focus();
          }
        }
      });
    });

    // --- ÙØ±Ù…Øª Ù‚ÛŒÙ…Øª ---
    const priceInput = document.querySelector('input[name="price"]');
    let rawPrice = "";

    function toPersianDigits(str) {
      return str.replace(/\d/g, d => "Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹"[d]);
    }

    function cleanNumber(str) {
      return str.replace(/[Û°-Û¹]/g, d => "Û°Û±Û²Û³Û´ÛµÛ¶Û·Û¸Û¹".indexOf(d)).replace(/[^\d]/g, "");
    }

    function formatPriceDisplay(value) {
      if (!value) return "";
      let formatted = value.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      return toPersianDigits(formatted) + " ØªÙˆÙ…Ø§Ù†";
    }

    // ØªØ§ÛŒÙ¾ Ù‡Ù…Ø²Ù…Ø§Ù† Ùˆ Ø­ÙØ¸ Ú©Ø±Ø³Ø± Ù¾Ø´Øª Ø¢Ø®Ø±ÛŒÙ† Ø¹Ø¯Ø¯
    priceInput.addEventListener('input', function (e) {
      const cursorPos = this.selectionStart;
      const oldLength = this.value.length;

      rawPrice = cleanNumber(this.value);
      this.value = formatPriceDisplay(rawPrice);

      const newLength = this.value.length;
      const diff = newLength - oldLength;

      // Ú©Ø±Ø³Ø± Ø±Ø§ Ù¾Ø´Øª Ø¢Ø®Ø±ÛŒÙ† Ø±Ù‚Ù… Ù‚Ø¨Ù„ Ø§Ø² " ØªÙˆÙ…Ø§Ù†" Ù‚Ø±Ø§Ø± Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…
      const pos = this.value.length - 6; // Ø·ÙˆÙ„ " ØªÙˆÙ…Ø§Ù†" = 6 Ú©Ø§Ø±Ø§Ú©ØªØ±
      this.selectionStart = this.selectionEnd = pos >= 0 ? pos : this.value.length;
    });

    priceInput.addEventListener('focus', function () {
      this.value = toPersianDigits(rawPrice);
    });

    priceInput.addEventListener('blur', function () {
      this.value = formatPriceDisplay(rawPrice);
    });


    form.addEventListener('submit', function(e) {
  if (!rawPrice) {
    e.preventDefault(); // Ø¬Ù„ÙˆÛŒ submit Ø±Ø§ Ø¨Ú¯ÛŒØ±
    alert("Ù„Ø·ÙØ§Ù‹ Ù‚ÛŒÙ…Øª Ù…Ù„Ú© Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!"); // Ù¾ÛŒØ§Ù… Ø®Ø·Ø§
    priceInput.focus();
  }
});
  

  </script>
</body>

</html>